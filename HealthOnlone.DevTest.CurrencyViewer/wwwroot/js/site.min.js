function ViewModel(){var n=this;n.datasources=ko.observableArray();n.listOfCurrencies=ko.observableArray();n.selectedCurrency1=ko.observable();n.selectedCurrency2=ko.observable();n.selectedProvider=ko.observable();n.selectedCurrencyForCalculation1=ko.observable();n.selectedCurrencyForCalculation2=ko.observable()}function getAverage(n){var r=model.datasources().length,u=0,t,i;if(r>0){for(t=0;t<r;t++)for(i=0;i<model.datasources()[t].currencies.length;i++)model.datasources()[t].currencies[i].name===n&&(u+=model.datasources()[t].currencies[i].rate);return u/r}return"waiting for data"}function convertBetweenProvider(n){for(var r=0,i=0,t=0;t<n.currencies.length;t++){if(r<0&&i<0)break;n.currencies[t].name===model.selectedCurrency1()&&(r=n.currencies[t].rate);n.currencies[t].name===model.selectedCurrency2()&&(i=n.currencies[t].rate)}return i>0?(r/i).toFixed(4):0}var model=new ViewModel;$(document).ready(function(){function t(){$.ajax("/api/v1/datasources").done(function(t){n=t;r(n)}).fail(function(){console.log("failed to get data sources")})}function i(n){function t(n,t){for(var e,u,f={source:t.dataSourceName,currencies:[]},r=Object.keys(n[0]),i=0;i<n.length;i++)e={name:n[i][r[0]],rate:n[i][r[2]]},model.listOfCurrencies.push(n[i][r[0]]),f.currencies.push(e);for(model.datasources.push(f),u=model.listOfCurrencies().filter((n,t)=>model.listOfCurrencies.indexOf(n)===t),model.listOfCurrencies.removeAll(),i=0;i<u.length;i++)model.listOfCurrencies.push(u[i])}$.ajax({url:"https://"+n.dataSourceUrl,type:"GET",crossDomain:!0,dataType:"json",source:n,success:function(i){t(i,n)},error:function(){alert("failed to get rates")}})}function r(n){for(var t=0;t<n.length;t++)i(n[t])}var n;ko.applyBindings(model);t()});